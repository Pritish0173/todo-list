<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
	<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
	<link rel="stylesheet" href="todo.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
		
    <style>
        body{
            background-image: url("https://i.pinimg.com/originals/59/e7/58/59e758cd94b6a989aa2cc7b4eeb68098.jpg");
        }

        table {
            width:100%;
        }
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            padding: 1%;
            text-align: center;
        }
        
        tr {
        background-color: #fff;
        }
        th {
            background-color: black;
            color: white;
        }

        .delete {
            background-color: red;
            color: white;

            /* padding: 5% 5%; */
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 5%;
        }

        .btn {
        /* width: 100%; */
        background-color: #4CAF50;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-left: 5%;
        }
    </style>
</head>
<body>
    <br>
    <br>
    <br>


    <div class="container" style="width:50%;margin-bottom: 10%;">
      <div class="card">
        <div class="card-body text-center">
          <p class="card-text">
            <div id="app"></div>

          </p>
        </div>
      </div>
    </div>

    <div class="container" style="width:50%;margin-bottom: 10%;">
        <div class="card">
          <div class="card-body text-center">
            <p class="card-text">
              <div id="recycle"></div>
  
            </p>
          </div>
        </div>
      </div>

	<!-- <div id="app"></div>
	<div id="recycle"></div> -->
</body>

<script type="text/babel">
	class RecycleBin extends React.Component {
		constructor(props){
			super(props);
			this.state = {cur_index:-1, prev_index:-1};
			this.cached = [];			
		}
		
		render() {
			if(this.state.cur_index>=0 && this.state.cur_index!=this.state.prev_index){
				this.cached.push(this.props.taskList);
			}
			
			return (
				<div className = 'todo-app'>
					<h1>Total tasks (RecycleBin){this.cached.length}</h1>
					<div align ="center">
						<table>						
							<tbody>
							{
							this.cached.map((taskList, index) => 
								<tr key={index}>
									<td>{taskList}</td>
									<td><button  onClick={()=> this.remove(taskList, index)}>Remove</button> &nbsp; &nbsp; <button  onClick={()=> this.restore(index)}>Restore</button></td>
								</tr> 
								)
							}
							</tbody>
						</table>
					</div>
				</div>
			);
		}
		
		
		remove = (index) => {
			this.cached.splice(index,1);
		}
		
		restore = (index) => {	
			this.cached.splice(index,1);
			console.log("after splice : ");
			console.log(this.cached);
			this.setState({cur_index:-1});
			//write your code to add stu to Student Component using props
		}
		
		getSnapshotBeforeUpdate(prevProps, prevState) {
			if(prevProps.index!=this.props.index){
				this.setState({cur_index:this.props.index});
			}
			return null;
		}
		
		componentDidUpdate(){
			
		}
		
		componentDidMount(){
			console.log("Mount", this.props.index)
			this.setState({cur_index:this.props.index});
		}
	}

	class User extends React.Component{
		constructor(props){
			super(props);
			this.state = {taskList: [], input:"", index:-1};
			this.cached = [];
		}
		
		render(){ 
			return(
				<div className='todo-app'>
					<h1>To-Do List</h1>
					<div align ="center">
					<input type='text' onChange={this.setInp} name='taskitem'  id="taskitem" value={this.state.input} placeholder='Add a Task' />
					<button className='greenShow' onClick={this.addtoList}>+</button><button className='greenShow' onClick={this.update}>Update</button>
					<div><h2>Tasks Left {this.state.taskList.length}</h2></div>
					<table>
						<tbody>

						{
							this.state.taskList.map((usr, i) => 
							<tr key={i}>
								
								<td>{usr}</td>
								<td><button className ="redShow" onClick={this.remove} value={i}>Delete</button></td>
								<td><button className ="greenShow" onClick={()=> this.edit(i)} value={i}>Edit</button></td>
							</tr>
							)
		
						}
						</tbody>						
					</table>
					</div>
				</div>				
			); 
		}

		setInp = (event) => {
			console.log(event.target.value)
			this.setState({input:event.target.value});
		}

		
		addtoList = () =>{
			const taskitem = this.state.input
			console.log(taskitem);
			if (taskitem === ""){
				alert("plase Add a Task")
			}
			else
			{
			this.setState({taskList:[...this.state.taskList,taskitem]});
			console.log(this.state.taskList);
			this.setState({input:""});
			}
		}

		remove = (e) => {
			// alert(e.target.value)
			const v = e.target.value
			const task = this.state.taskList[v];			
			const tasks = this.state.taskList; 
			tasks.splice(v,1);
			this.setState({taskList:tasks});
			// console.log(this.state.taskList);
			ReactDOM.render(<RecycleBin index={v} taskList={task}/>, document.getElementById("recycle"));

		}
		 edit = (i) =>{
			this.setState({input:this.state.taskList[i], index:i}); 
		 }


        update =()=>{
                const i=this.state.index
               // alert(this.state.list[r]);
			   	const taskList = this.state.taskList
				if(i>=0){
					taskList[i] = this.state.input
				}
                this.setState({taskList: taskList});
            	this.setState({input:"", index:-1});
        }


		// componentDidMount(){
		// 	const taskList = localStorage.getItem("taskList");
		// 	if(taskList!=null){
		// 		this.setState({taskList:JSON.parse(taskList)});
		// 	}
			
		// 	window.addEventListener("beforeunload", ()=>{
		// 		localStorage.setItem("students",JSON.stringify(this.state.taskList));
		// 	});
		// }

		getTaskList = () => {
			fetch('https://raw.githubusercontent.com/Pritish0173/todo-list/master/taskList.json') 
			.then(resp => resp.json())
			.then(data => {
				console.log(data);
				this.setState({taskList:data});
			});
		}
		
		componentDidMount(){
			this.getTaskList();
		}
		
		
		componentWillUnmount(){
		}
	}

	class App extends React.Component{
		render(){
			return(
				<div>
					<User/>
				</div>
			);
		}
	}

	ReactDOM.render(<App/>, document.querySelector('#app'));
	
// 	// Set the date we're counting down to
// var countDownDate = new Date("Jan 5, 2022 15:37:25").getTime();

// // Update the count down every 1 second
// var x = setInterval(, 1000);


</script>

</html>